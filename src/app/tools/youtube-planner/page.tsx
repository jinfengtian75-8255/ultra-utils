'use client'

import { useState, useEffect, useMemo, useRef } from 'react'
import { Wand2, Sparkles, Zap, Copy, Check, Video, MessageSquare, Tag, Lightbulb, ChevronRight, Terminal, Sliders, Download } from 'lucide-react'
import { cn } from '@/lib/utils'
import { useLanguage } from '@/context/language-context'
import AdBanner from '@/components/AdBanner'

export default function YoutubePlannerPage() {
    const { t } = useLanguage()
    const [isMounted, setIsMounted] = useState(false)
    const [videoType, setVideoType] = useState('vlog')
    const [topic, setTopic] = useState('')
    const [tone, setTone] = useState('funny')
    const [target, setTarget] = useState('general')
    const [isGenerating, setIsGenerating] = useState(false)
    const [showResults, setShowResults] = useState(false)
    const [activeTab, setActiveTab] = useState('titles')
    const [mobileView, setMobileView] = useState<'setup' | 'results'>('setup')
    const [copied, setCopied] = useState<boolean | 'all'>(false)
    const toolRef = useRef<HTMLDivElement>(null)

    useEffect(() => {
        setIsMounted(true)
    }, [])

    const handleGenerate = () => {
        if (!topic) return
        setIsGenerating(true)
        setShowResults(false)

        // Simulate AI processing
        setTimeout(() => {
            setIsGenerating(false)
            setShowResults(true)
            // Auto switch to results on mobile
            setMobileView('results')

            // Precision Scroll: Scroll directly to the tool container start
            if (window.innerWidth < 1024 && toolRef.current) {
                const offset = toolRef.current.offsetTop - 80;
                window.scrollTo({ top: offset, behavior: 'smooth' });
            }
        }, 1500)
    }

    const handleCopy = (text: string) => {
        navigator.clipboard.writeText(text)
        setCopied(text === 'all' ? 'all' : true)
        setTimeout(() => setCopied(false), 2000)
    }

    const handleDownload = () => {
        if (!generatedContent) return
        const content = `
[ ${t.ytPlanner.title} - ${topic} ]
-----------------------------------------
1. ${t.ytPlanner.tabTitles}
${generatedContent.titles.join('\n')}

2. ${t.ytPlanner.tabTags}
${generatedContent.tags}

3. ${t.ytPlanner.tabScripts}
${generatedContent.script}

4. ${t.ytPlanner.tabStrategy}
${generatedContent.strategy}
-----------------------------------------
Generated by UltraUtils AI
        `
        const blob = new Blob([content], { type: 'text/plain' })
        const url = URL.createObjectURL(blob)
        const a = document.createElement('a')
        a.href = url
        a.download = `yt_plan_${topic.replace(/\s+/g, '_')}.txt`
        document.body.appendChild(a)
        a.click()
        document.body.removeChild(a)
        URL.revokeObjectURL(url)
    }

    // --- Dynamic AI Simulation Logic ---
    const generatedContent = useMemo(() => {
        if (!topic) return null;

        // 1. Titles generation based on Video Type and Tone
        const titlePatterns = {
            vlog: {
                funny: [
                    `ğŸ¤£ ${topic} í•˜ë‹¤ê°€ ì§„ì§œ ë°°ê¼½ ë¹ ì§ˆ ë»”...`,
                    `í˜„ì‹¤íŒ ${topic}! ë¸Œì´ë¡œê·¸ ì°ë‹¤ ë©˜ë¶• ì˜¨ ì‚¬ì—°`,
                    `ëˆ„ê°€ ${topic}ì„ ì´ë ‡ê²Œ í•´ìš”? ã…‹ã…‹ã…‹ (feat. ë³‘ë§›)`,
                    `ì ˆëŒ€ ë”°ë¼í•˜ì§€ ë§ˆì„¸ìš”... ${topic} ëŒ€ì‹¤íŒ¨ ë¸Œì´ë¡œê·¸`
                ],
                serious: [
                    `ì§„ì†”í•˜ê²Œ ë‹´ì•„ë³¸ ${topic}ì˜ ê¸°ë¡`,
                    `ë‚˜ì˜ ì†Œì¤‘í•œ ì¼ìƒ, ê·¸ë¦¬ê³  ${topic}...`,
                    `ë‚´ê°€ ${topic}ì„ ê³„ì†í•˜ëŠ” ì´ìœ  (ì†”ì§í•œ ì‹¬ì •)`,
                    `ë§ˆìŒì´ í¸í•´ì§€ëŠ” ${topic} íë§ ë¸Œì´ë¡œê·¸`
                ],
                professional: [
                    `í”„ë¡œ í¬ë¦¬ì—ì´í„°ì˜ ${topic} ë¼ì´í”„ ìŠ¤íƒ€ì¼`,
                    `${topic}ê³¼ í•¨ê»˜í•˜ëŠ” ìƒì‚°ì ì¸ í•˜ë£¨ ë£¨í‹´`,
                    `ê³ í€„ë¦¬í‹° ì¼ìƒ ì˜ìƒ: ${topic} í¸`,
                    `íš¨ìœ¨ì ì¸ ${topic}ì„ ìœ„í•œ ë¸Œì´ë¡œê·¸ ì¥ë¹„ ì„¸íŒ…`
                ]
            },
            info: {
                funny: [
                    `ë¹¡ì¹˜ê¸° ì „ì— ê¼­ ë´ì•¼í•  ${topic} ì™„ë²½ ê°€ì´ë“œ`,
                    `ì¼ë¯¼ì´ë„ ì´í•´í•˜ëŠ” ${topic} ì´ˆê°„ë‹¨ ì •ë¦¬`,
                    `${topic} í•˜ë‹¤ê°€ ë¹¡ì³ì„œ ë§Œë“  ì˜ìƒ (í•µê¹”ë”)`,
                    `ì´ê±° ëª¨ë¥´ë©´ ${topic} í•˜ë‹¤ê°€ í˜¸êµ¬ ë©ë‹ˆë‹¤ ã…‹ã…‹`
                ],
                serious: [
                    `${topic}ì˜ ìˆ¨ê²¨ì§„ ìœ„ê¸°, ìš°ë¦¬ê°€ ëª°ëë˜ ì§„ì‹¤`,
                    `í•™ìˆ ì ìœ¼ë¡œ ì ‘ê·¼í•œ ${topic}ì˜ ê¸°ì›ê³¼ ë¯¸ë˜`,
                    `${topic}, ê³¼ì—° ì´ëŒ€ë¡œ ê´œì°®ì€ê°€? (ì‹¬ì¸µ ë¶„ì„)`,
                    `ì‹¬ë„ ê¹Šì€ í†µì°°: ${topic}ì— ëŒ€í•œ ëª¨ë“  ë¦¬í¬íŠ¸`
                ],
                professional: [
                    `[ì „ë¬¸ê°€ ê°€ì´ë“œ] ${topic} ì™„ë²½ ë§ˆìŠ¤í„°í•˜ê¸°`,
                    `${topic} ì‹¤ì „ ì „ëµ: ìƒìœ„ 1%ë§Œ ì•„ëŠ” ë…¸í•˜ìš°`,
                    `ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œì˜ ${topic} í™œìš©ë²•`,
                    `${topic} ì…ë¬¸ë¶€í„° ì‹¬í™”ê¹Œì§€! 1ì‹œê°„ ì••ì¶• ê°•ì˜`
                ]
            },
            review: {
                funny: [
                    `ëˆ ì§€ë„ì¸ê°€? ${topic} ì§ì ‘ ì¨ë³´ë‹ˆ... ğŸ˜‚`,
                    `ê´‘ê³  ì•„ë‹˜! ${topic} ë‚´ëˆë‚´ì‚° ì†”ì§ ë¦¬ë·° (ìš• ì£¼ì˜)`,
                    `ëŒ€ê¸°ì—…ì´ ì‹«ì–´í•  ${topic} ë‹¨ì  íŒ©íŠ¸ í­ê²©`,
                    `${topic}? ê·¸ëƒ¥ ì´ê±° ì‚¬ì§€ ë§ˆì„¸ìš” ã…‹ã…‹ã…‹`
                ],
                serious: [
                    `${topic} í•œ ë‹¬ ì‚¬ìš©ê¸°: ê³¼ì—° ê¸°ëŒ€ë§Œí¼ì¼ê¹Œ?`,
                    `ê°ê´€ì ìœ¼ë¡œ ë¹„êµí•œ ${topic} vs ê²½ìŸ ëª¨ë¸`,
                    `ì „ë¬¸ê°€ê°€ í‰ê°€í•œ ${topic}ì˜ ë‚´êµ¬ì„± í…ŒìŠ¤íŠ¸`,
                    `${topic}, ì¥ì ë³´ë‹¤ ë‹¨ì ì´ ë” ì¹˜ëª…ì ì¸ ì´ìœ `
                ],
                professional: [
                    `ì‚°ì—… í‘œì¤€ ì ê²€: ${topic} ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸`,
                    `ì—”ì§€ë‹ˆì–´ ì…ì¥ì—ì„œ ë³¸ ${topic}ì˜ ê¸°ìˆ ì  êµ¬ì¡°`,
                    `B2B ë¦¬ë·°: ê¸°ì—…ìš©ìœ¼ë¡œ ë³¸ ${topic}ì˜ ê°€ì¹˜`,
                    `${topic} ì‹¬ì¸µ ë¶„ì„: ì„±ëŠ¥ê³¼ ê°€ì„±ë¹„ì˜ ê· í˜•ì `
                ]
            },
            shorts: {
                funny: [
                    `${topic} 1ì´ˆ ë§Œì— í•˜ëŠ” ë²• ã…‹ã…‹ã…‹`,
                    `í”í•œ í•œêµ­ì¸ì˜ ${topic} ì†ë„... ë¯¸ì³¤ìŒ`,
                    `ì ˆëŒ€ ëê¹Œì§€ ë³´ì§€ë§ˆì„¸ìš”... ${topic} ë°˜ì „`,
                    `ì§„ì§œ ${topic} ëíŒì™• ë“±ì¥ ã„·ã„·`
                ],
                serious: [
                    `60ì´ˆ ì•ˆì— ë°°ìš°ëŠ” ${topic}ì˜ í•µì‹¬`,
                    `ì•„ë¬´ë„ ëª°ëë˜ ${topic}ì˜ ì†Œë¦„ë‹ëŠ” ì‚¬ì‹¤`,
                    `ë‹¹ì‹ ì´ ë†“ì¹˜ê³  ìˆëŠ” ${topic} ê¿€íŒ`,
                    `ë‹¨ 30ì´ˆ, ${topic}ì´ ì¸ìƒì„ ë°”ê¿€ ìˆ˜ ìˆë‹¤ë©´?`
                ],
                professional: [
                    `í”„ë¡œê°€ ì•Œë ¤ì£¼ëŠ” ${topic} ìˆí¼ ê³µì‹`,
                    `${topic} íš¨ìœ¨ 200% ë†’ì´ëŠ” ë°©ë²•`,
                    `Shorts ì „ëµ: ${topic} ì•Œê³ ë¦¬ì¦˜ íƒ€ëŠ” ë²•`,
                    `ë°”ìœ í˜„ëŒ€ì¸ì„ ìœ„í•œ ${topic} 60ì´ˆ ìš”ì•½`
                ]
            }
        };

        const currentType = titlePatterns[videoType as keyof typeof titlePatterns] || titlePatterns.vlog;
        const currentTone = currentType[tone as keyof typeof currentType] || currentType.professional;

        const shuffled = [...currentTone].sort(() => 0.5 - Math.random());
        const selectedTitles = shuffled.slice(0, 5);

        const tagBases = ['YouTube', 'Creator', 'Tip', 'Trend', 'Viral'];
        const dynamicTags = [topic, ...tagBases.map(b => topic + b), 'UltraUtils'].map(t => `#${t.replace(/\s+/g, '')}`).join(' ');

        const scriptIntros = {
            beginner: `ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ '${topic}'ì— ì•„ì˜ˆ ì…ë¬¸í•˜ì‹œëŠ” ë¶„ë“¤ì„ ìœ„í•´ í•˜ë‚˜ë¶€í„° ì—´ê¹Œì§€ ì‰½ê²Œ ì„¤ëª…í•´ ë“œë¦´ê²Œìš”.`,
            general: `ì•ˆë…•í•˜ì„¸ìš”! ìš”ì¦˜ í•«í•œ '${topic}', ê³¼ì—° ì™œ í™”ì œì¼ê¹Œìš”? ì˜¤ëŠ˜ ì˜ìƒì—ì„œ ì™„ë²½í•˜ê²Œ íŒŒí—¤ì³ ë“œë¦½ë‹ˆë‹¤.`,
            expert: `ë°˜ê°‘ìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ ì˜ìƒì—ì„œëŠ” '${topic}'ì˜ ê³ ë„í™”ëœ ë©”ì»¤ë‹ˆì¦˜ê³¼ í˜„ì—…ì—ì„œ ì ìš© ê°€ëŠ¥í•œ ì‹¤ë¬´ í…Œí¬ë‹‰ì„ ë‹¤ë£¹ë‹ˆë‹¤.`
        };

        const currentIntro = scriptIntros[target as keyof typeof scriptIntros] || scriptIntros.general;

        return {
            titles: selectedTitles,
            tags: dynamicTags,
            thumbnailText: [
                `ğŸ˜± ${topic} ì§„ì§œ ì‹¤í™”?`,
                `ì‚¬ì¥ë‹˜ ëª°ë˜ ì°ìŒ...`,
                `ì¸ìƒ í•„ìˆ˜í…œ ${topic}`,
                `${topic} 1ë¶„ ì»·!`
            ],
            script: `[ì¸íŠ¸ë¡œ: 15ì´ˆ]\n${currentIntro}\n\n[ë³¸ë¡ : 3ë¶„]\n1. ${topic}ì˜ í•µì‹¬ ê°œë… (ì•Œê³  ê³„ì…¨ë‚˜ìš”?)\n2. ${tone === 'funny' ? 'ë³‘ë§› ì„ì¸' : tone === 'professional' ? 'ì „ë¬¸ì ì¸' : 'ê¼¼ê¼¼í•œ'} ì‹¤ì „ í™œìš© ì‚¬ë¡€\n3. ${target === 'beginner' ? 'ì´ˆë³´ìë§Œ ì•„ëŠ” ì‹¤ìˆ˜' : 'ê³ ìˆ˜ê°€ ì•Œë ¤ì£¼ëŠ” íŒ'} 3ê°€ì§€\n\n[ì•„ì›ƒíŠ¸ë¡œ: 30ì´ˆ]\nì˜¤ëŠ˜ ì˜ìƒë„ ëê¹Œì§€ ì‹œì²­í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ${topic} ê´€ë ¨ ì§ˆë¬¸ì€ ëŒ“ê¸€ë¡œ ë¶€íƒë“œë ¤ìš”!`,
            strategy: `ğŸ“ ${topic} ë…¸ì¶œ ì „ëµ:\n1. ì¸ë„¤ì¼ í¬ì¸íŠ¸: ${tone === 'funny' ? 'í‘œì •ì´ í™”ë ¤í•œ ì¸ë„¤ì¼' : 'ê¹”ë”í•˜ê³  ê°€ë…ì„± ì¢‹ì€ í°íŠ¸'}ì™€ '${topic}' í‚¤ì›Œë“œ ê°•ì¡°\n2. ì‹œì²­ ëŒ€ìƒ [${target}]ì´(ê°€) ìì£¼ ê²€ìƒ‰í• ë§Œí•œ í‚¤ì›Œë“œë¥¼ ì„¤ëª… ìƒë‹¨ì— 3ë²ˆ ë°˜ë³µ ë…¸ì¶œ\n3. ${videoType === 'shorts' ? 'ë£¨í”„(ë°˜ë³µ)' : 'ì´ˆë°˜ 15ì´ˆ '} ì´íƒˆ ë°©ì§€ ì¥ì¹˜ ë§ˆë ¨`
        };
    }, [topic, videoType, tone, target]);

    if (!isMounted) return null

    const videoTypes = [
        { id: 'vlog', label: t.ytPlanner.vlog, icon: Video },
        { id: 'info', label: t.ytPlanner.info, icon: Lightbulb },
        { id: 'review', label: t.ytPlanner.review, icon: Sparkles },
        { id: 'shorts', label: t.ytPlanner.shorts, icon: Zap }
    ]

    return (
        <div className="max-w-7xl mx-auto space-y-12 pb-20">
            {/* Header Section */}
            <div className="text-center space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700">
                <div className="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-amber-500/10 text-amber-600 dark:text-amber-400 text-xs font-bold uppercase tracking-widest border border-amber-500/20">
                    <Sparkles className="w-4 h-4" /> Creator Studio
                </div>
                <h1 className="text-4xl font-extrabold tracking-tight sm:text-6xl">
                    <span className="text-gradient from-amber-500 to-rose-500 font-black">{t.ytPlanner.title}</span>
                </h1>
                <p className="text-muted-foreground text-lg max-w-2xl mx-auto leading-relaxed">
                    {t.ytPlanner.desc}
                </p>
            </div>

            {/* Top Ad Slot */}
            <div className="max-w-4xl mx-auto px-4">
                <AdBanner slot="top-banner-planner" />
            </div>

            <div ref={toolRef} className="space-y-8">
                {/* Mobile View Toggle */}
                <div className="lg:hidden sticky top-16 z-40 flex bg-white/95 dark:bg-zinc-950/95 backdrop-blur-md p-1.5 rounded-2xl border border-zinc-200 dark:border-zinc-800 shadow-xl mx-4">
                    <button
                        onClick={() => setMobileView('setup')}
                        className={cn(
                            "flex-1 py-3 rounded-xl text-sm font-black transition-all flex items-center justify-center gap-2",
                            mobileView === 'setup' ? "bg-amber-500 text-white shadow-md" : "text-zinc-500"
                        )}
                    >
                        <Sliders className="w-4 h-4" /> {t.ytPlanner.setupTab}
                    </button>
                    <button
                        onClick={() => setMobileView('results')}
                        className={cn(
                            "flex-1 py-3 rounded-xl text-sm font-black transition-all flex items-center justify-center gap-2",
                            mobileView === 'results' ? "bg-amber-500 text-white shadow-md" : "text-zinc-500"
                        )}
                    >
                        <Terminal className="w-4 h-4" /> {t.ytPlanner.resultsTab}
                        {showResults && <span className="w-2 h-2 rounded-full bg-rose-500 animate-pulse" />}
                    </button>
                </div>

                <div className="grid lg:grid-cols-2 gap-12 items-start px-4">
                    {/* Left Side: Inputs */}
                    <div className={cn(
                        "glass-card p-6 sm:p-10 rounded-[2.5rem] sm:rounded-[3rem] space-y-8 sm:space-y-10 animate-in fade-in slide-in-from-left-8 duration-700 delay-200",
                        mobileView !== 'setup' && "hidden lg:block"
                    )}>
                        <div className="space-y-6">
                            <label className="text-sm font-bold flex items-center gap-2 uppercase tracking-widest text-muted-foreground italic">
                                1. {t.ytPlanner.videoType}
                            </label>
                            <div className="grid grid-cols-2 gap-3">
                                {videoTypes.map((type) => (
                                    <button
                                        key={type.id}
                                        onClick={() => setVideoType(type.id)}
                                        className={cn(
                                            "relative group flex items-center justify-center gap-3 py-5 px-6 rounded-2xl font-bold transition-all overflow-hidden",
                                            videoType === type.id
                                                ? "bg-amber-500 text-white shadow-xl scale-[1.02]"
                                                : "bg-zinc-100 dark:bg-zinc-800 text-muted-foreground hover:bg-zinc-200 dark:hover:bg-zinc-700"
                                        )}
                                    >
                                        <type.icon className={cn("w-5 h-5", videoType === type.id ? "animate-pulse" : "group-hover:scale-110 transition-transform")} />
                                        <span>{type.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="space-y-6">
                            <label className="text-sm font-bold flex items-center gap-2 uppercase tracking-widest text-muted-foreground italic lg:mt-6">
                                2. {t.ytPlanner.topic}
                            </label>
                            <div className="relative group">
                                <input
                                    value={topic}
                                    onChange={(e) => setTopic(e.target.value)}
                                    placeholder={t.ytPlanner.topicPlaceholder}
                                    className="w-full pl-8 pr-16 py-6 rounded-3xl bg-zinc-100 dark:bg-zinc-800 border-2 border-transparent focus:border-amber-500/30 focus:ring-4 focus:ring-amber-500/10 text-xl font-medium transition-all outline-none"
                                />
                                <div className="absolute right-6 top-1/2 -translate-y-1/2 text-muted-foreground opacity-50 group-focus-within:text-amber-500 group-focus-within:opacity-100 transition-all pointer-events-none">
                                    <MessageSquare className="w-6 h-6" />
                                </div>
                            </div>
                        </div>

                        <div className="pt-6 border-t border-zinc-100 dark:border-zinc-800 space-y-8">
                            <div className="space-y-4">
                                <label className="text-xs font-black uppercase tracking-widest text-muted-foreground/60">{t.ytPlanner.advancedOptions}</label>
                                <div className="grid grid-cols-2 gap-8">
                                    <div className="space-y-4">
                                        <span className="text-sm font-bold block">{t.ytPlanner.tone}</span>
                                        <select
                                            value={tone}
                                            onChange={(e) => setTone(e.target.value)}
                                            className="w-full px-4 py-3 rounded-xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 text-sm font-medium outline-none focus:ring-2 focus:ring-amber-500/20 transition-all"
                                        >
                                            <option value="funny">{t.ytPlanner.toneFunny}</option>
                                            <option value="serious">{t.ytPlanner.toneSerious}</option>
                                            <option value="professional">{t.ytPlanner.toneProfessional}</option>
                                        </select>
                                    </div>
                                    <div className="space-y-4">
                                        <span className="text-sm font-bold block">{t.ytPlanner.targetAudience}</span>
                                        <select
                                            value={target}
                                            onChange={(e) => setTarget(e.target.value)}
                                            className="w-full px-4 py-3 rounded-xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 text-sm font-medium outline-none focus:ring-2 focus:ring-amber-500/20 transition-all"
                                        >
                                            <option value="general">{t.ytPlanner.targetGeneral}</option>
                                            <option value="expert">{t.ytPlanner.targetExpert}</option>
                                            <option value="beginner">{t.ytPlanner.targetBeginner}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <button
                                onClick={handleGenerate}
                                disabled={!topic || isGenerating}
                                className={cn(
                                    "w-full py-6 rounded-[2rem] font-black text-2xl flex items-center justify-center gap-4 transition-all shadow-2xl relative overflow-hidden group",
                                    topic && !isGenerating
                                        ? "bg-gradient-to-r from-amber-500 via-rose-500 to-amber-500 bg-[length:200%_auto] hover:bg-right hover:scale-[1.02] active:scale-95 text-white"
                                        : "bg-zinc-200 dark:bg-zinc-800 text-muted-foreground cursor-not-allowed"
                                )}
                            >
                                {isGenerating ? (
                                    <>
                                        <Wand2 className="w-8 h-8 animate-spin" />
                                        <span>{t.ytPlanner.generating}</span>
                                    </>
                                ) : (
                                    <>
                                        <Zap className="w-8 h-8 group-hover:animate-bounce" />
                                        <span>{t.ytPlanner.generateBtn}</span>
                                    </>
                                )}
                            </button>
                        </div>
                    </div>

                    {/* Right Side: Results */}
                    <div className={cn(
                        "space-y-8 animate-in fade-in slide-in-from-right-8 duration-700 delay-300",
                        mobileView !== 'results' && "hidden lg:block"
                    )}>
                        <div className="overflow-hidden rounded-[2.5rem] sm:rounded-[3rem] shadow-2xl bg-zinc-950 border border-white/10 flex flex-col min-h-[500px] sm:min-h-[640px]">
                            {/* Fake Browser Header */}
                            <div className="bg-zinc-900 p-6 flex items-center justify-between border-b border-white/5 h-20">
                                <div className="flex gap-2">
                                    <div className="w-3 h-3 rounded-full bg-rose-500/40" />
                                    <div className="w-3 h-3 rounded-full bg-amber-500/40" />
                                    <div className="w-3 h-3 rounded-full bg-emerald-500/40" />
                                </div>
                                <div className="flex bg-zinc-800/50 p-1 rounded-xl">
                                    {['titles', 'scripts', 'tags', 'strategy'].map((tab) => (
                                        <button
                                            key={tab}
                                            onClick={() => setActiveTab(tab)}
                                            className={cn(
                                                "px-4 py-1.5 rounded-lg text-xs font-black transition-all",
                                                activeTab === tab
                                                    ? "bg-amber-500 text-white shadow-lg"
                                                    : "text-zinc-500 hover:text-zinc-300"
                                            )}
                                        >
                                            {t.ytPlanner[tab === 'titles' ? 'tabTitles' : tab === 'scripts' ? 'tabScripts' : tab === 'tags' ? 'tabTags' : 'tabStrategy']}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Content Area */}
                            <div className="flex-1 p-10 font-mono relative overflow-y-auto max-h-[500px] scrollbar-hide">
                                {!showResults ? (
                                    <div className="h-full flex flex-col items-center justify-center text-center space-y-6 opacity-40">
                                        <Terminal className="w-16 h-16" />
                                        <p className="font-mono text-sm uppercase tracking-widest">Waiting for creative input...</p>
                                    </div>
                                ) : (
                                    <div className="animate-in fade-in slide-in-from-bottom-5 duration-500">
                                        <div className="text-amber-500 text-sm mb-6 flex items-center gap-2 select-none">
                                            <ChevronRight className="w-4 h-4" />
                                            <span className="text-zinc-600">~/projects/viral-video</span>
                                            <span className="text-zinc-400">$ plan --output {activeTab}</span>
                                        </div>

                                        <div className="space-y-6">
                                            {activeTab === 'titles' && (
                                                <>
                                                    {generatedContent?.titles.map((title: string, i: number) => (
                                                        <div key={i} className="group relative p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-amber-500/30 transition-all font-sans">
                                                            <p className="text-white text-lg leading-relaxed">{title}</p>
                                                            <button
                                                                onClick={() => handleCopy(title)}
                                                                className="absolute top-4 right-4 opacity-0 group-hover:opacity-100 p-2 text-amber-500 transition-all bg-zinc-900 rounded-lg shadow-xl"
                                                            >
                                                                <Copy className="w-4 h-4" />
                                                            </button>
                                                        </div>
                                                    ))}
                                                    <div className="mt-8 pt-8 border-t border-white/10 space-y-4 font-sans">
                                                        <span className="text-xs font-black text-rose-500 uppercase tracking-widest italic flex items-center gap-2">
                                                            <Sparkles className="w-4 h-4" /> Thumbnail Hook Recommendation
                                                        </span>
                                                        <div className="grid grid-cols-2 gap-3">
                                                            {generatedContent?.thumbnailText.map((text: string, i: number) => (
                                                                <div key={i} className="p-3 bg-rose-500/10 border border-rose-500/20 rounded-xl text-white text-sm font-bold text-center">
                                                                    {text}
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </>
                                            )}

                                            {activeTab === 'tags' && (
                                                <div className="p-6 rounded-2xl bg-white/5 border border-white/5 font-sans">
                                                    <p className="text-amber-400 text-xl tracking-wide leading-loose">{generatedContent?.tags}</p>
                                                </div>
                                            )}

                                            {activeTab === 'scripts' && (
                                                <div className="p-6 rounded-2xl bg-white/5 border border-white/5 whitespace-pre-wrap font-sans text-white/90 leading-relaxed text-lg">
                                                    {generatedContent?.script}
                                                </div>
                                            )}

                                            {activeTab === 'strategy' && (
                                                <div className="p-6 rounded-2xl bg-white/5 border border-white/5 whitespace-pre-wrap font-sans text-emerald-400 leading-relaxed text-lg">
                                                    {generatedContent?.strategy}
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Footer Copy All Button */}
                            <div className="p-8 bg-zinc-900/50 border-t border-white/5 mt-auto space-y-3">
                                <button
                                    onClick={() => handleCopy(
                                        activeTab === 'titles' ? (generatedContent?.titles.join('\n') || '') :
                                            activeTab === 'tags' ? (generatedContent?.tags || '') :
                                                activeTab === 'scripts' ? (generatedContent?.script || '') :
                                                    (generatedContent?.strategy || '')
                                    )}
                                    disabled={!showResults}
                                    className={cn(
                                        "w-full py-5 rounded-2xl font-black text-lg flex items-center justify-center gap-3 transition-all",
                                        !showResults ? "bg-zinc-800 text-zinc-500 cursor-not-allowed" :
                                            copied ? "bg-emerald-600 text-white" : "bg-white text-zinc-950 hover:bg-zinc-200"
                                    )}
                                >
                                    {copied ? <><Check className="w-6 h-6" /> {t.ytPlanner.copied}</> : <><Copy className="w-6 h-6" /> {t.ytPlanner.copyAll}</>}
                                </button>
                                <div className="grid grid-cols-2 gap-3">
                                    <button
                                        onClick={handleDownload}
                                        disabled={!showResults}
                                        className={cn(
                                            "w-full py-4 rounded-2xl font-bold text-base flex items-center justify-center gap-2 transition-all bg-zinc-800 text-zinc-300 hover:bg-zinc-700",
                                            !showResults && "opacity-50 cursor-not-allowed"
                                        )}
                                    >
                                        <Download className="w-5 h-5" /> .TXT
                                    </button>
                                    <button
                                        onClick={async () => {
                                            await navigator.clipboard.writeText(window.location.href);
                                            alert(t.common.copiedLink);
                                        }}
                                        disabled={!showResults}
                                        className={cn(
                                            "w-full py-4 rounded-2xl font-bold text-base flex items-center justify-center gap-2 transition-all bg-zinc-800 text-zinc-300 hover:bg-zinc-700",
                                            !showResults && "opacity-50 cursor-not-allowed"
                                        )}
                                    >
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" /></svg>
                                        Share Tool
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {/* Bottom Ad Slot */}
            <div className="max-w-4xl mx-auto px-4 mt-12">
                <AdBanner slot="bottom-banner-planner" />
            </div>

            {/* Guide Section */}
            <div className="mt-24 space-y-16 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-500 px-4">
                <div className="text-center space-y-4">
                    <h2 className="text-3xl font-black sm:text-4xl">{t.ytPlanner.guide.title}</h2>
                    <p className="text-muted-foreground">{t.ytPlanner.guide.subtitle}</p>
                </div>

                <div className="grid md:grid-cols-3 gap-8">
                    {t.ytPlanner.guide.sections.map((section: any, i: number) => (
                        <div key={i} className="glass-card p-8 rounded-[2.5rem] space-y-4 hover:shadow-xl transition-shadow border-2 border-amber-500/5">
                            <div className="w-12 h-12 rounded-2xl bg-amber-500/10 flex items-center justify-center text-amber-600 font-black text-xl">
                                {i + 1}
                            </div>
                            <h3 className="text-xl font-bold">{section.title}</h3>
                            <p className="text-muted-foreground leading-relaxed text-sm">
                                {section.content}
                            </p>
                        </div>
                    ))}
                </div>

                {/* FAQ Section */}
                <div className="max-w-3xl mx-auto space-y-8">
                    <h3 className="text-2xl font-black text-center mb-10">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</h3>
                    <div className="grid gap-4">
                        {t.ytPlanner.guide.faq.map((item: any, i: number) => (
                            <div key={i} className="glass-card p-6 rounded-2xl border border-zinc-100 dark:border-zinc-800">
                                <h4 className="font-bold text-lg mb-2 text-amber-600 dark:text-amber-400">Q. {item.q}</h4>
                                <p className="text-muted-foreground text-sm leading-relaxed">{item.a}</p>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
        </div>
    )
}
